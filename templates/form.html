<!DOCTYPE html>
<html lang="tr">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Veri GiriÅŸi Formu</title>
    <style>
        body {
            font-family: Arial, sans-serif;
            background-color: #f0f8ff;
            color: #333;
            margin: 0;
            padding: 0;
        }
        .container {
            max-width: 80%;
            margin: 20px auto;
            background-color: white;
            padding: 20px;
            border-radius: 10px;
            box-shadow: 0 4px 10px rgba(0, 0, 0, 0.1);
        }
        h1, h2 {
            text-align: center;
            color: #007bff;
        }
        form {
            display: flex;
            flex-direction: column;
            gap: 10px;
        }
        label {
            font-weight: bold;
        }
        input, select {
            width: 100%;
            padding: 8px;
            border: 1px solid #ccc;
            border-radius: 5px;
        }
        .buttons {
            display: flex;
            justify-content: space-around;
            margin-top: 20px;
        }
        .buttons button {
            padding: 10px 20px;
            border: none;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }
        .save-btn { background-color: #4caf50; color: white; }
        .submit-btn { background-color: #007bff; color: white; }
        .list-btn { background-color: #ff9800; color: white; }
        .buttons button:hover { opacity: 0.8; }
    </style>
</head>
<body>
   <div class="container">
    <h1>Veri GiriÅŸi Formu</h1>

    <h2>Hasta Bilgileri</h2>
    <form id="tahminForm" method="POST">



        <label for="isim">Ä°sim:</label>
        <input type="text" id="isim" name="Isim" required>

        <label for="soyisim">Soyisim:</label>
        <input type="text" id="soyisim" name="Soyisim" required>

        <label for="kimlik_no">Kimlik No:</label>
        <input type="text" id="kimlik_no" name="Kimlik_No" required>

<h2>SaÄŸlÄ±k Bilgileri</h2>
<label for="yas">YaÅŸ:</label>
<input type="number" id="yas" name="YaÅŸ" required>

<label for="cinsiyet">Cinsiyet:</label>
<select id="cinsiyet" name="Cinsiyet" required>
    <option value="KadÄ±n">KadÄ±n</option>
    <option value="Erkek">Erkek</option>
</select>

<label for="bmi">BMI:</label>
<input type="number" id="bmi" name="BMI" step="0.1" required>

<label for="nabiz">NabÄ±z:</label>
<input type="number" id="nabiz" name="NabÄ±z" required>

<label for="tansiyon_sistolik">Tansiyon Sistolik:</label>
<input type="number" id="tansiyon_sistolik" name="Tansiyon_Sistolik" required>

<label for="tansiyon_diastolik">Tansiyon Diastolik:</label>
<input type="number" id="tansiyon_diastolik" name="Tansiyon_Diastolik" required>
<label for="oksijen_doygunlugu">Oksijen DoygunluÄŸu (%):</label>
<input type="number" id="oksijen_doygunlugu" name="Oksijen_DoygunluÄŸu" required><br>

 <label for="kalp_hastaligi">Kalp HastalÄ±ÄŸÄ±:</label>
 <select id="kalp_hastaligi" name="Kalp_Hastaligi" required>
     <option value="Evet">Evet</option>
     <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="kanser">Kanser:</label>
<select id="kanser" name="Kanser" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="tansiyon_problemi">Tansiyon Problemi:</label>
<select id="tansiyon_problemi" name="Tansiyon_Problemi" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="kolesterol_sorunu">Kolesterol Sorunu:</label>
<select id="kolesterol_sorunu" name="Kolesterol_Sorunu" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="panik_atak">Panik Atak:</label>
<select id="panik_atak" name="Panik_Atak" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="son_ameliyat">Son Ameliyat:</label>
<select id="son_ameliyat" name="Son_Ameliyat" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="kirik">KÄ±rÄ±k:</label>
<select id="kirik" name="Kirik" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>
<label for="cikik">Ã‡Ä±kÄ±k:</label>
<select id="cikik" name="Cikik" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="kalp_krizi">Kalp Krizi:</label>
<select id="kalp_krizi" name="Kalp_Krizi" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="ic_kanama">Ä°Ã§ Kanama:</label>
<select id="ic_kanama" name="Ic_Kanama" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="kesik">Kesik:</label>
<select id="kesik" name="Kesik" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="yaralanma">Yaralanma:</label>
<select id="yaralanma" name="Yaralanma" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="beyin_kanamasi">Beyin KanamasÄ±:</label>
<select id="beyin_kanamasi" name="Beyin_Kanamasi" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="uzuv_kopmasi">Uzuv KopmasÄ±:</label>
<select id="uzuv_kopmasi" name="Uzuv_Kopmasi" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="sikisma">SÄ±kÄ±ÅŸma:</label>
<select id="sikisma" name="Sikisma" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="omurilik_zedelenmesi">Omurilik Zedelenmesi:</label>
<select id="omurilik_zedelenmesi" name="Omurilik_Zedelenmesi" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="agri_seviyesi">AÄŸrÄ± Seviyesi (1-10):</label>
<input type="number" id="agri_seviyesi" name="AÄŸrÄ±_Seviyesi" min="1" max="10" required>

<label for="stres_seviyesi">Stres Seviyesi (1-10):</label>
<input type="number" id="stres_seviyesi" name="Stres_Seviyesi" min="1" max="10" required>

<label for="tedavi_suresi">Tedaviye UlaÅŸma SÃ¼resi (dk):</label>
<input type="number" id="tedavi_suresi" name="Tedaviye_UlaÅŸma_SÃ¼resi" required>
<label for="saglik_ekibi_kapasitesi">SaÄŸlÄ±k Ekibi Kapasitesi:</label>
<input type="number" id="saglik_ekibi_kapasitesi" name="SaÄŸlÄ±k_Ekibi_Kapasitesi" min="1" max="5" required>

<label for="ates">AteÅŸ (Â°C):</label>
<input type="number" id="ates" name="AteÅŸ" step="0.1" required>

<label for="bulanti">BulantÄ±:</label>
<select id="bulanti" name="BulantÄ±" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="kusma">Kusma:</label>
<select id="kusma" name="Kusma" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="bayilma">BayÄ±lma:</label>
<select id="bayilma" name="BayÄ±lma" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="bilinc_durumu">BilinÃ§ Durumu:</label>
<select id="bilinc_durumu" name="BilinÃ§_Durumu" required>
    <option value="Normal">Normal</option>
    <option value="Sersem">Sersem</option>
    <option value="BilinÃ§siz">BilinÃ§siz</option>
</select>
    
<label for="epilepsi">Epilepsi:</label>
<select id="epilepsi" name="Epilepsi" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="koah">KOAH:</label>
<select id="koah" name="KOAH" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>
<label for="bobrek_yetmezligi">BÃ¶brek YetmezliÄŸi:</label>
<select id="bobrek_yetmezligi" name="BÃ¶brek_YetmezliÄŸi" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="yanik">YanÄ±k:</label>
<select id="yanik" name="YanÄ±k" required>
    <option value="1. Derece">1. Derece</option>
    <option value="2. Derece">2. Derece</option>
    <option value="3. Derece">3. Derece</option>
    <option value="Yok">Yok</option>
</select>

<label for="zehirlenme">Zehirlenme:</label>
<select id="zehirlenme" name="Zehirlenme" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="bogulma">BoÄŸulma:</label>
<select id="bogulma" name="BoÄŸulma" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="siddetli_bas_agrisi">Åiddetli BaÅŸ AÄŸrÄ±sÄ± (1-10):</label>
<input type="number" id="siddetli_bas_agrisi" name="Åiddetli_BaÅŸ_AÄŸrÄ±sÄ±" min="1" max="10" required>

<label for="laboratuvar_sonuclari">Laboratuvar SonuÃ§larÄ±:</label>
<input type="number" id="laboratuvar_sonuclari" name="Laboratuvar_SonuÃ§larÄ±" required>

<label for="kan_sekeri">Kan Åekeri:</label>
<input type="number" id="kan_sekeri" name="Kan_Åekeri" required>

<label for="kalp_hizi_degisenligi">Kalp HÄ±zÄ± DeÄŸiÅŸkenliÄŸi:</label>
<input type="number" id="kalp_hizi_degisenligi" name="Kalp_HÄ±zÄ±_DeÄŸiÅŸkenliÄŸi" step="0.1" required>
<label for="nefes_darligi">Nefes DarlÄ±ÄŸÄ±:</label>
<select id="nefes_darligi" name="Nefes_DarlÄ±ÄŸÄ±" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>
<label for="hastanin_medikal_gecmisi">HastanÄ±n Medikal GeÃ§miÅŸi:</label>
<select id="hastanin_medikal_gecmisi" name="HastanÄ±n_Medikal_GeÃ§miÅŸi" required>
    <option value="Kalp">Kalp HastalÄ±klarÄ±</option>
    <option value="BÃ¶brek">BÃ¶brek HastalÄ±klarÄ±</option>
    <option value="AkciÄŸer">AkciÄŸer HastalÄ±klarÄ±</option>
    <option value="KOAH">KOAH (Kronik ObstrÃ¼ktif AkciÄŸer HastalÄ±ÄŸÄ±)</option>
    <option value="Kanser">Kanser</option>
    <option value="Tansiyon">Tansiyon Problemi</option>
    <option value="Diyabet">Åeker HastalÄ±ÄŸÄ± (Diyabet)</option>
    <option value="Epilepsi">Epilepsi</option>
    <option value="KaraciÄŸer">KaraciÄŸer HastalÄ±klarÄ±</option>
    <option value="Sinir_Sistemi">Sinir Sistemi HastalÄ±klarÄ±</option>
    <option value="Normal">Normal (Kronik HastalÄ±k Yok)</option>
</select>

<label for="sok_belirtileri">Åok Belirtileri:</label>
<select id="sok_belirtileri" name="Åok_Belirtileri" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="goz_bebegi_tepkisi">GÃ¶z BebeÄŸi Tepkisi:</label>
<select id="goz_bebegi_tepkisi" name="GÃ¶z_BebeÄŸi_Tepkisi" required>
    <option value="Normal">Normal</option>
    <option value="YavaÅŸ">YavaÅŸ</option>
    <option value="Tepkisiz">Tepkisiz</option>
</select>

<label for="ishal">Ä°shal:</label>
<select id="ishal" name="Ä°shal" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="agri_konumu">AÄŸrÄ± Konumu:</label>
<select id="agri_konumu" name="AÄŸrÄ±_Konumu" required>
    <option value="BaÅŸ">BaÅŸ</option>
    <option value="KarÄ±n">KarÄ±n</option>
    <option value="GÃ¶ÄŸÃ¼s">GÃ¶ÄŸÃ¼s</option>
    <option value="SÄ±rt">SÄ±rt</option>
    <option value="Bacak">Bacak</option>
    <option value="Kol">Kol</option>
    <option value="AÄŸrÄ± Yok">AÄŸrÄ± Yok</option>
</select>

<label for="gogus_agrisi">GÃ¶ÄŸÃ¼s AÄŸrÄ±sÄ±:</label>
<select id="gogus_agrisi" name="GÃ¶ÄŸÃ¼s_AÄŸrÄ±sÄ±" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="vucut_sicakligi_degisim">VÃ¼cut SÄ±caklÄ±ÄŸÄ± DeÄŸiÅŸkenliÄŸi (Â°C):</label>
<input type="number" id="vucut_sicakligi_degisim" name="VÃ¼cut_SÄ±caklÄ±ÄŸÄ±_DeÄŸiÅŸkenliÄŸi" step="0.1" required>
<label for="susuzluk_belirtileri">Susuzluk Belirtileri:</label>
<select id="susuzluk_belirtileri" name="Susuzluk_Belirtileri" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="son24_saat_yemek">Son 24 Saatte Yemek Yedi:</label>
<select id="son24_saat_yemek" name="Son_24_Saatte_Yemek_Yedi" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="cilt_kurulugu">Cilt KuruluÄŸu:</label>
<select id="cilt_kurulugu" name="Cilt_KuruluÄŸu" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="norolojik_belirtiler">NÃ¶rolojik Belirtiler:</label>
<select id="norolojik_belirtiler" name="NÃ¶rolojik_Belirtiler" required>
    <option value="Normal">Normal</option>
    <option value="KonuÅŸma BozukluÄŸu">KonuÅŸma BozukluÄŸu</option>
    <option value="UyuÅŸukluk">UyuÅŸukluk</option>
</select>

<label for="hasta_kac_saat">Hasta KaÃ§ Saat Ã–nce YaralandÄ±:</label>
<input type="number" id="hasta_kac_saat" name="Hasta_KaÃ§_Saat_Ã–nce_YaralandÄ±" required>

<label for="olay_turu">Olay TÃ¼rÃ¼:</label>
<select id="olay_turu" name="Olay_TÃ¼rÃ¼" required>
    <option value="Trafik KazasÄ±">Trafik KazasÄ±</option>
    <option value="Ev KazasÄ±">Ev KazasÄ±</option>
    <option value="Spor YaralanmasÄ±">Spor YaralanmasÄ±</option>
    <option value="Sanayi KazasÄ±">Sanayi KazasÄ±</option>
    <option value="Olay Yok">Olay Yok</option>
</select>

<label for="ilk_mudahale">Ä°lk MÃ¼dahale YapÄ±ldÄ±:</label>
<select id="ilk_mudahale" name="Ä°lk_MÃ¼dahale_YapÄ±ldÄ±" required>
    <option value="Evet">Evet</option>
    <option value="HayÄ±r">HayÄ±r</option>
</select>

<label for="onceki_hastane">HastanÄ±n Ã–nceki Hastane Ziyaretleri:</label>
<input type="number" id="onceki_hastane" name="HastanÄ±n_Ã–nceki_Hastane_Ziyaretleri" required>

<label for="acil_geldigi_saat">Acil Servise GeldiÄŸi Saat:</label>
<input type="number" id="acil_geldigi_saat" name="Acil_Servise_GeldiÄŸi_Saat" required>

        <div class="buttons">
    <button type="button" class="save-btn" onclick="saveFormData()">Kaydet</button>
    <button type="submit" class="submit-btn" onclick="submitForm(event)">GÃ¶nder</button>
    <button type="button" class="submit-btn" id="tahminBtn">Tahmin Yap</button>
    <button type="button" class="submit-btn" onclick="downloadReport()">Ä°ndir</button>
    <button type="button" class="list-btn">Listele</button>
</div>
</form> <!-- ğŸ” Form burada dÃ¼zgÃ¼n ÅŸekilde kapatÄ±ldÄ± -->

<!-- âœ… Tahmin sonucu ve SHAP gÃ¶rseli -->
<div id="tahminSonuc" style="font-weight: bold; margin-top: 20px;"></div>
<div id="shapSonuc" style="margin-top: 10px;"></div>

</div> <!-- container -->

<script>
    // âœ… "Kaydet" Butonu - Form Verilerini TarayÄ±cÄ±da Sakla
    function saveFormData() {
        let formData = new FormData(document.querySelector("form"));
        let savedData = {};

        formData.forEach((value, key) => {
            savedData[key] = value;
        });

        localStorage.setItem("savedFormData", JSON.stringify(savedData));
        alert("Form verileri kaydedildi!");
    }

    // âœ… "GÃ¶nder" Butonu (Backend Entegrasyonu Ä°Ã§in HazÄ±r)
    function submitForm(event) {
        event.preventDefault();  // SayfanÄ±n yenilenmesini engeller
        alert("Form baÅŸarÄ±yla gÃ¶nderildi!");
        document.querySelector("form").reset();  // Formu temizler
    }

    document.addEventListener("DOMContentLoaded", function () {
        const tahminBtn = document.getElementById("tahminBtn");
        const form = document.getElementById("tahminForm");

        if (!form || !tahminBtn) {
            console.error("âŒ Form veya tahmin butonu bulunamadÄ±!");
            return;
        }

        tahminBtn.addEventListener("click", async function () {
            console.log("âœ… Tahmin butonuna tÄ±klandÄ±, iÅŸlem baÅŸlÄ±yor!");

            const formData = new FormData(form);
            let jsonData = {};

            formData.forEach((value, key) => {
                const parsed = parseFloat(value);
                jsonData[key] = isNaN(parsed) ? value : parsed;
            });

            console.log("ğŸ“¤ JSON olarak gÃ¶nderilen veri:", jsonData);

            try {
                const response = await fetch("/tahmin", {
                    method: "POST",
                    headers: {
                        "Content-Type": "application/json"
                    },
                    body: JSON.stringify(jsonData)
                });

                if (!response.ok) {
                    throw new Error("Sunucu hatasÄ±: " + response.status);
                }

                const result = await response.json();
                console.log("ğŸ“¥ Tahmin sonucu alÄ±ndÄ±:", result);

                if (result.tahmin !== undefined) {
                    document.getElementById("tahminSonuc").textContent = "Tahmin Sonucu: " + result.tahmin;
                    document.getElementById("shapSonuc").innerHTML = result.shap_html || "SHAP gÃ¶rseli bulunamadÄ±.";
                } else if (result.hata) {
                    alert("âš ï¸ Tahmin hatasÄ±: " + result.hata);
                } else {
                    alert("âš ï¸ Beklenmeyen yanÄ±t formatÄ±!");
                }

            } catch (error) {
                console.error("âŒ Tahmin sÄ±rasÄ±nda hata:", error);
                alert("âŒ Sunucuya baÄŸlanÄ±lamadÄ± veya hata oluÅŸtu: " + error.message);
            }
        });
    });
</script>

</body>
</html>

